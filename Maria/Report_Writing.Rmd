---
title: "Bayesian Spatio-Temporal modelling of crime against women in Uttar Pradesh"
author: "Wanqing Fang, Ben Ling, Maria Serova, Yi Zhou"
date: "31/03/2025"
output:
  html_document:
    fig_caption: true
  pdf_document: default
always_allow_html: true
header-includes: \usepackage{bm}
#bibliography: biblio.bib
abstract: Include your Abstract here. This should be an unstructured abstract of 200
  words, summarising the main contents of the scientific report.
editor_options:
  markdown:
    wrap: sentence
---

```{=tex}
\pagenumbering{gobble} 
\pagenumbering{arabic}
```
```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE, message=FALSE, warning=FALSE, fig.align = "center", class.source='klippy')
```

```{r klippy, echo=FALSE, include=TRUE}
klippy::klippy(position = c('top', 'right'),color = 'darkred',
               tooltip_message = 'Click to copy', tooltip_success = 'Done')
```

```{r eval=TRUE, echo=FALSE}
# Load the libraries 
library(dplyr)        
library(sf)           
library(spdep)        
library(tidyr)        
library(INLA)         
library(ggplot2)      
library(viridis)    
library(patchwork)    
library(knitr)
library(kableExtra)

# Prepare directory and data
#rm(list=ls())
setwd(dirname(rstudioapi::getActiveDocumentContext()$path))
load("../../CrimeUttarPradesh.RData")

# load figures
load("Figures.RData")
```


# Introduction

This section should convey two key pieces of information: the background information necessary to place the scientific report in context, and the clear and complete specification of the purpose(s).
In particular, think about:

-   What is known about the subject

-   What is not know

-   Why is it important to fill this research gap

-   What is exactly the research question

To include citations, please refers to the practicals used in our module and the file of the Instructions.

# Methods

Data were sourced from the National Crime Record Bureau, covering rape and dowry deaths in 70 districts of Uttar Pradesh, North India, from 2001 to 2014. The dataset includes annual crime counts, population data, expected case numbers, and standardized incidence ratios (SMRs) for both rape and dowry deaths.

We first merged spatial data with statistical data for geographic visualization. For each region, the standardized incidence ratio (SMR = O/E) was calculated over 14 years, where \( O \) is the observed and \( E \) the expected number of cases. To visualize regional risk differences, we created a regional average SMR map (Figure 1) and plotted annual average SMRs to assess temporal patterns across districts (Figure 1).

Bayesian hierarchical models were used to model crime risk over space and time. We fitted three models: (1) a spatial model using BYM2 random effects to capture district-level variation; (2) a spatial-temporal model extending (1) with a temporal component \( \gamma_t \sim \text{RW1} \); and (3) a spatial-temporal type-I interaction model adding a spatial-temporal interaction term $\delta_{it} \sim \mathcal{N}(0, \sigma^2_\delta)$ to allow for region-specific temporal trends.

\normalsize
\renewcommand{\arraystretch}{1.0}
\setlength{\tabcolsep}{6pt}

\begin{center}
\begin{tabular}{p{0.33\textwidth} p{0.33\textwidth} p{0.33\textwidth}}

\textbf{Model -- 1} &
\textbf{Model -- 2} &
\textbf{Model -- 3} \\

$O_i \sim \text{Poisson}(\rho_i E_i)$ &
$O_{it} \sim \text{Poisson}(\rho_{it} E_{it})$ &
$O_{it} \sim \text{Poisson}(\rho_{it} E_{it})$ \\

$\log \rho_i = b_0 + b_i$ &
$\log \rho_{it} = b_0 + b_i + \gamma_t$ &
$\log \rho_{it} = b_0 + b_i + \gamma_t + \delta_{it}$ \\

$\mathbf{b} = \dfrac{1}{\sqrt{\tau_b}} \left( \sqrt{1 - \phi} \mathbf{v_*} + \sqrt{\phi} \mathbf{u_*} \right)$ &
$\mathbf{b} = \dfrac{1}{\sqrt{\tau_b}} \left( \sqrt{1 - \phi} \mathbf{v_*} + \sqrt{\phi} \mathbf{u_*} \right)$ &
$\mathbf{b} = \dfrac{1}{\sqrt{\tau_b}} \left( \sqrt{1 - \phi} \mathbf{v_*} + \sqrt{\phi} \mathbf{u_*} \right)$ \\

&
$\gamma_t \sim \text{RW(1)}$ &
$\gamma_t \sim \text{RW(1)}$ \\

& &
$\delta_{it} \sim \mathcal{N}(0, \sigma^2_\delta)$ \\

\end{tabular}
\end{center}

The spatial component in all models was defined using the BYM2 parameterization, where the spatial effect $b_i$ is decomposed into structured and unstructured components as:

\[
b_i = \frac{1}{\sqrt{\tau_b}} \left( \sqrt{1 - \phi} \cdot v_i + \sqrt{\phi} \cdot u_i \right)
\]
where $v_i$ represents unstructured (iid) noise and $u_i$ represents structured spatial variation. $\phi$ controls the proportion of spatial variation explained by the structured component, and $\tau_b$ is the overall precision.

Penalized Complexity (PC) priors were used for all precision and spatial mixing parameters to impose regularization and reduce overfitting. Each PC prior is defined by two hyperparameters: \( U \), the upper limit reflecting a reasonable maximum value, and \( \alpha \), where \( P(\theta > U) = \alpha \) controls the prior’s strength. For all precision parameters, we set \( P(\sigma > 0.5) = 0.01 \), corresponding to \( U = 0.31 \) and \( \alpha = 0.01 \), indicating a strong belief in smooth effects across space and time. For the spatial mixing parameter \( \phi \), we set \( P(\phi < 0.5) = \frac{2}{3} \), indicating a preference for unstructured spatial variation.

To assess model sensitivity to hyperprior choices, we tested three PC prior configurations for the BYM2 model with type I spatial-temporal interaction: (1) Base PC with \( U = 0.31 \), \( \alpha = 0.01 \), and \( P(\phi < 0.5) = \frac{2}{3} \); (2) Weaker Shrinkage with \( U = 0.50 \), \( \alpha = 0.01 \), and \( P(\phi < 0.5) = 0.5 \); and (3) Stronger Spatial with \( U = 0.30 \), \( \alpha = 0.05 \), and \( P(\phi < 0.5) = 0.8 \). These settings reflect varying levels of shrinkage and spatial structure preference. They were applied to both dowry death and rape models. Model performance was evaluated using DIC and WAIC, with posterior summaries of key hyperparameters extracted.


# Results

## Descriptive analysis

Between 2001 and 2014, the total number of reported rape cases and dowry deaths was 25,513 and 28,600, respectively, with the corresponding yearly means of 2,043 (±334) and 1,822 (±691).
Several districts frequently exhibited the highest yearly rates, such as Philibit and Chitrakoot (rape) and Alogarh (dowry deaths).
In contrast, Sant Ravidas Nagar Bhadohi frequently had the lowest rates of both crimes (Supplementary Table 1).
Temporal evolutions of unsmoothed standardised mortality ratios (SMRs) reveal a general increase in both crimes from 2003, stabilising for dowry deaths after 2008, and increasing sharply for rape from 2010 onwards (Figure 1).
District-level trajectories (Supplementary Figure 1) show substantial variability, motivating the use of spatio-temporal smoothing and interaction terms.
Spatially aggregated unsmoothed SMRs reveal a gradient of increasing crime rates towards the West of the region (Figure 1).
This spatial patterning further motivates the use of smoothing models to enable strength borrowing from neighbours, hence producing higher confidence risk estimates.

```{r EDA-figure, fig.width=12, fig.height=3, fig.cap="Figure 1"}
# Plot unsmoothed data
unsmoothed
```

## Model comparison

We fit spatial (S), spatio-temporal (ST), and spatio-temporal with Interaction Type I (ST+I) model for each crime type.
All three models captured similar spatial clusters of elevated and lower risks and corresponding exceedance probabilities.
The S and ST models yielded similar smoothed maps of posterior spatial RRs (Supplementary Figures 2-3).
Including an interaction term enabled identification of several regions of higher risk and higher exceedance probabilities for both crimes.
Furthermore, the ST+I model yielded lower WAIC for both crimes compared to the ST model (Table 1), indicating a better fit (S model was not included in this comparison as it was fit on aggregate data).
It was therefore deemed the most appropriate model, with its results discussed further in this section.

```{r wiac_table, fig.cap="Table 1"}
waic_table
```

## Spatial effects

The district-specific posterior means of spatial relative risks (RRs) (column 1) and corresponding exceedance probabilities (column 2) for both rapes and dowry deaths are shown in Figure 2.
```{r stInt_m, fig.width=10, fig.height=6, fig.cap="Figure 2"}
stInt_m
```

For dowry deaths, a gradient of increasing risk from East to West is apparent.
A pronounced high-risk cluster can be observed in the South-Western districts, particularly concentrated around Etah and Mainpuri.
This is corroborated by the high exceedance probabilities (0.8-1) in this area.
In contrast, the Eastern and North-Western regions predominantly exhibit lower RRs and exceedance probabilities.

These patterns are largely mirrored by rape RRs, with the Eastern area also exhibiting lower risk.
However, the spatial pattern of higher risk is more dispersed, with two clusters identified in the South and North-West, concentrated around Bulandshahr and Chitrakoot.
Additionally, the rape RRs exhibit a wider range (0.294-2.28) compared to dowry death RRs (0.423-2.1).

This is corroborated by the precision hyperparameter of the spacial component (BYM2) of the two models, with lower precision (and hence higher variance) in rape model indicating greater spatial variability of rape (Table 2).
```{r stInt_hyper_table}
stInt_hyper
```

The precision hyperparameter of spatial (ID_area) effect is lower that that of temporal (ID_year) and interaction (ID_area_year) components in both rape and dowry models, indicating that spatial effects explain most of the variability seen in posterior RRs.
Furthermore, the high value of phi hyperparameter of both models shows that most of the spatial variation is structured.

## Temporal and spatio-temporal effects

The temporal trajectories of posterior risk means (Figure 3) are largely similar between the ST and the ST+I models for both crimes, with wider CIs of the ST+I model accounting for district-specific temporal trajectories.
```{r temp_st_stInt, fig.width=12, fig.height=3, fig.cap="Figure 3"}
temp_st_stInt
```

For dowry deaths, the overall temporal trend is relatively flat, dropping in 2003 before stabilising around 1.
The temporal trend of rapes is much sharper, exhibiting a more pronounced drop in 2003, and a much steeper rise afterwards, particularly after 2010.
This is also reflected in the posterior precision hyperparameter, which is notably lower in the rape model than the dowry model, indicating a higher temporal variability of rapes.
The ST+I model includes both the national temporal trends and the region-specific deviations, with the residual RRs of interaction term capturing how each region’s temporal pattern differs from the overall trend. There are no notable patterns of interaction effects for dowry deaths, with some clusters observed for dowry deaths (for more information, please see Supplementary Figure 4).

## Overall dynamics of posterior mean relative risks

Posterior mean RRs of the ST+I model, combining spatial, temporal, and spatio-temporal components, and hence capturing geographical and temporal dynamics, are shown for both crimes in Figure 4.
```{r meanRR_Post, fig.width=8, fig.height=10, fig.cap="Figure 4"}
meanRR_post
```

For both, there is a noticeable decline in risk leading up to 2003, particularly concentrated in the eastern part of the region and especially pronounced for rape.
Following this decline, dowry death risks experience a mild resurgence before stabilising.
In contrast, rape risks increase more markedly across most of the region, and again more strongly in the east.
By the end of the study period, several districts exhibit posterior RRs in the range of 2.5 to 4.75, indicating significantly elevated risk relative to regional baseline.

# Discussion and conclusion

This section should synthetically discuss your answer to the research question and how your findings compare or contrast with previous results.
You can refer to the potential implications and future perspectives and/or application of present work.
Think about:

-   Your key results

-   What your study adds

-   Comparison with existing literature/interpretation of findings

-   Strength and weakness of your study

-   Recommendation for future research and/or for policies

# Supplementary material

```{r dist_table, fig.width=12, fig.height=12, fig.cap="Supplementary Table 1"}
reg_table
```

```{r reg_temp_smr, fig.width=12, fig.height=3, fig.cap="Supplementary Figure 1"}
region_temp_smrs
```

```{r rape_all_m, fig.width=8.5, fig.height=10, fig.cap="Supplementary Figure 2: Rape"}
# Plot unsmoothed data
rape_all_m
```

```{r dowry_all_m, fig.width=8.5, fig.height=10, fig.cap="Supplementary Figure 3: Dowry"}
# Plot unsmoothed data
dowry_all_m
```

```{r int_map, fig.width=8.5, fig.height=10, fig.cap="Supplementary Figure 4: Interaction"}
int_map
```


# References

-   You should update the attached file `biblio.bib` with your references.

-   The references cited in the mini-project report will be automatically inserted after this header.
